<div class="main-сontainer__content">

<div id="wrapper" xmlns="http://www.w3.org/1999/html">
    <div id="page-wrapper">
        <div class="container-fluid">

            <!-- Page Heading -->
            <div class="row">
                <div class="col-lg-10 chat-block" (mouseenter)="mouseEnter()" (mouseleave)="mouseLeave()">

                    <div class="main_section">

                        <div class="chat_container">


                            <div class="col-sm-3 chat_sidebar" [class.waiting]="loadingChats">
                                <div class="row">

                                    <div class="member_list">
                                        <ul class="list-unstyled">
                                            <li class="left clearfix" *ngIf="!currentChat">
                                                Chats list is empty.
                                            </li>
                                            <li class="left clearfix" *ngFor="let chat of chatList; let i = index;"
                                                (click)="getMessages(chat?.conversationId)"
                                                [class.active]="chat?.conversationId == currentChat?.conversationId">
                                                 <span class="chat-img pull-left">
                                                 <img *ngIf="chat?.companion?.photo_url"
                                                      src="{{ chat?.companion?.photo_url }}"
                                                      class="img-circle">
                                                     <img *ngIf="!chat?.companion?.photo_url" src="../../assets/img/user.png"
                                                          class="img-circle">
                                                 </span>
                                                <div class="chat-body clearfix">
                                                    <div class="header_sec">
                                                        <strong class="primary-font">{{ chat?.nameToDisplay }}</strong>
                                                    </div>
                                                    <div class="contact_sec">
                                                        <span class="primary-font">{{ chat?.last_message }} <div *ngIf="chat?.newMessages" class="waiting-point"></div></span>
                                                        <span *ngIf="chat?.count_unread > 0" class="badge pull-right">{{ chat?.count_unread }}</span>
                                                    </div>
                                                    <div class="contact_sec">
                                                        <p class="pull-right">{{ chat?.last_message_date }}</p>
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
                                        <button *ngIf="visibleChatsMore" (click)="getChats(true)"
                                                class="btn btn-default btn-new-messages">Load more..
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <!--chat_sidebar-->


                            <div class="col-sm-9 message_section" [class.waiting]="loadingMessages">
                                <div class="row">
                                    <div class="new_message_head">
                                        <div class="pull-left" *ngIf="currentChat">
                                            {{ currentChat?.nameToDisplay}}
                                        </div>
                                        <div class="pull-left" *ngIf="!currentChat">
                                            Not selected chat.
                                        </div>
                                    </div><!--new_message_head-->

                                    <div class="chat_area">
                                        <!--<button *ngIf="messageLoadMoreVisible && currentChat != null"
                                                (click)="getMessages(currentChat?.id, true)"
                                                class="btn btn-default btn-new-messages">Load more..
                                        </button>-->
                                        <ul class="list-unstyled" *ngIf="currentChat" id="message-box">

                                            <li class="left clearfix"
                                                *ngFor="let message of messageList; let i = index;"
                                                [class.admin_chat]="message?.userId !== 1">
                                                 <span *ngIf="message?.userId === 1"
                                                       class="chat-img1 pull-left">
                                                     <!--<img src="{{ currentChat?.companion?.photo_url }}"
                                                          class="img-circle">-->

                                                 </span>
                                                <span *ngIf="message?.userId !== 1"
                                                      class="chat-img1 pull-right">
                                                     <!--<img src="{{ myPhotoUrl }}"
                                                          class="img-circle">-->
                                                 </span>
                                                <div class="chat-body1 clearfix">
                                                    <div *ngIf="message?.userId !== 1"
                                                         class="arrow-left"></div>
                                                    <div *ngIf="message?.userId === 1"
                                                         class="arrow-right"></div>
                                                    <p>{{ message?.text }}</p>
                                                    <div *ngIf="message?.userId !== 1"
                                                         class="chat_time pull-right">{{ message?.created_at }}
                                                    </div>
                                                    <div *ngIf="message?.userId === 1"
                                                         class="chat_time pull-left">{{ message?.created_at }}
                                                    </div>

                                                </div>
                                            </li>


                                        </ul>
                                        <div id="bottom-area"></div>
                                    </div><!--chat_area-->
                                    <div *ngIf="currentChat">
                                        <form class="message_write" [formGroup]="messageForm" (ngSubmit)="sendMessage()"
                                              novalidate>
                                            <textarea class="form-control" formControlName="message"
                                                      placeholder="type a message"></textarea>
                                            <div class="clearfix"></div>
                                            <div class="chat_bottom">

                                                <button [disabled]="messageForm.get('message').invalid || loadingMessages" type="submit"
                                                        href="#" class="send-message-button pull-right btn btn-success">
                                                    Send
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div> <!--message_section-->
                        </div>

                    </div>

                </div>
            </div>
            <!-- /.row -->

        </div>
        <!-- /.container-fluid -->

    </div>
    <!-- /#page-wrapper -->

</div>
<!-- /#wrapper -->
</div>
